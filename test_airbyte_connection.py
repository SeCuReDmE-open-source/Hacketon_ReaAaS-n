import requests\nimport json\nimport os\n\ndef test_airbyte_connection():\n    airbyte_url = os.environ.get("AIRBYTE_API_URL", "http://localhost:8000/api/v1")\n    connection_id = os.environ.get("AIRBYTE_CONNECTION_ID")\n\n    headers = {\n        "Content-Type": "application/json",\n        "Accept": "application/json"\n    }\n\n    # Check connection status\n    response = requests.post(\n        f"{airbyte_url}/connections/get",\n        headers=headers,\n        json={"connectionId": connection_id}\n    )\n\n    print(f"Connection status: {response.status_code}")\n    print(json.dumps(response.json(), indent=2))\n\n    # Trigger a sync\n    sync_response = requests.post(\n        f"{airbyte_url}/connections/sync",\n        headers=headers,\n        json={"connectionId": connection_id}\n    )\n\n    print(f"Sync trigger status: {sync_response.status_code}")\n    print(json.dumps(sync_response.json(), indent=2))\n\nif __name__ == "__main__":\n    test_airbyte_connection()
